"""
Обработчик помощи
"""

from aiogram.types import Message
from aiogram.fsm.context import FSMContext
from loguru import logger


async def help_handler(message: Message, state: FSMContext):
    """Обработчик команды /help"""
    help_text = """
❓ <b>Справка по использованию бота</b>

<b>Основные команды:</b>
• /start - главное меню
• /parse [URL] - парсинг указанного URL
• /history - история парсинга
• /settings - настройки парсера
• /help - эта справка

<b>Как использовать:</b>
1. <b>Парсинг URL:</b>
   - Нажмите "Парсить URL" или используйте /parse
   - Отправьте ссылку на страницу вуза
   - Дождитесь результатов

2. <b>Просмотр результатов:</b>
   - Используйте "История" для просмотра прошлых результатов
   - Проверяйте достоверность найденных данных
   - Экспортируйте результаты в CSV

3. <b>Настройки:</b>
   - Rate Limit: задержка между запросами
   - Глубина: количество уровней для обхода
   - JS рендеринг: для динамических страниц
   - Confidence: минимальный порог достоверности

<b>Поддерживаемые сайты:</b>
• Страницы кафедр и факультетов
• Списки сотрудников
• Поисковые страницы вузов
• Любые сайты с информацией о преподавателях

<b>Формат результатов:</b>
• ФИО (Фамилия Имя Отчество)
• Должность
• Email адрес
• Оценка достоверности (0-1)
• Источник данных

<b>Советы по использованию:</b>
• Используйте прямые ссылки на страницы сотрудников
• При низких результатах попробуйте включить JS рендеринг
• Проверяйте найденные данные вручную
• Экспортируйте результаты для дальнейшего использования

<b>Ограничения:</b>
• Соблюдение robots.txt
• Rate limiting для вежливого парсинга
• Таймауты для предотвращения зависания
• Фильтрация по достоверности

<b>Поддержка:</b>
При возникновении проблем:
1. Проверьте корректность URL
2. Попробуйте изменить настройки
3. Обратитесь к администратору

<b>GDPR и приватность:</b>
• Все данные хранятся локально
• Используйте /delete_my_data для удаления
• Данные не передаются третьим лицам
• Логи не содержат персональной информации
"""
    
    await message.answer(help_text, parse_mode="HTML")
